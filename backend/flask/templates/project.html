{% extends "base.html" %}

{% block title %}{% if project %}{{ project.name }} - Project{% else %}Projects{% endif %}{% endblock %}

{% block main %}
  <div class="projects-container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h1 class="mb-0">Projects</h1>
      <button class="btn btn-primary btn-sm" id="btn-open-project-modal">
        <i class="fa fa-plus"></i> Add Project
      </button>
    </div>
    {% if projects is defined and projects %}
      <div class="row g-4">
        {% for proj in projects %}
          <div class="col-6 col-md-4 col-xxl-3">
            <a href="{{ url_for('tasks.project_detail', project_id=proj.id) }}" class="text-decoration-none">
              <div class="card h-100 project-card">
                <div class="card-body d-flex flex-column">
                  <div class="d-flex justify-content-between align-items-start">
                    <h5 class="card-title mb-1">{{ proj.name }}</h5>
                    <span class="state-badge {{ proj.state }}">{{ proj.state.replace('_', ' ') | title }}</span>
                  </div>

                  {% if proj.description %}
                    <p class="card-text text-muted small mb-2">{{ proj.description }}</p>
                  {% endif %}

                  <div class="mt-auto">
                    <div class="d-flex justify-content-between align-items-center">
                      <div class="text-muted small">
                        {% if proj.expected_start_date or proj.expected_end_date %}
                          <div>
                            {{ proj.expected_start_date or '' }}
                            {% if proj.expected_start_date and proj.expected_end_date %} - {% endif %}
                            {{ proj.expected_end_date or '' }}
                          </div>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                </div>
                <div class="card-footer d-flex justify-content-between align-items-center">
                  <small class="text-muted">Tasks: {{ proj.tasks | length }}</small>
                </div>
              </div>
            </a>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-center text-muted mt-5">No projects to show.</div>
    {% endif %}
  </div>
  {% include 'components/project/project_modal.html' %}
{% endblock %}

{% block styles %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/project.css') }}" />
{% endblock %}

{% block scripts %}
  <script src="{{ url_for('static', filename='js/project.js') }}"></script>
{% endblock %}
